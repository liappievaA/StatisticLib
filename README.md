### README

# Тестирование волатильности и параметров моделей с использованием перекрывающихся наблюдений

Этот репозиторий содержит реализацию подхода к тестированию волатильности и параметров моделей на основе перекрывающихся наблюдений, описанного в статье "Backtesting Volatility Assumptions Using Overlapping Observations" Майкла А. Клейтона. В дополнение к этому, в репозитории представлены два Python-ноутбука, которые демонстрируют тестирование моделей арифметического броуновского движения (ABM) и модели Кокса-Ингерсолла-Росса (CIR).

---

## Описание

### Реализованные тесты
1. **Тест Колмогорова-Смирнова (KS)**:
   - Проверяет равномерность стандартизированных наблюдений.
2. **Тест Андерсона-Дарлинга (AD)**:
   - Более чувствителен к отклонениям в концах распределения.
3. **Тест отношения правдоподобия (LR)**:
   - Сравнивает наблюдаемую дисперсию с ожидаемой.

### Варианты тестирования
- **Без перекрытия интервалов**: Наблюдения не пересекаются.
- **С перекрытием интервалов**: Наблюдения частично пересекаются, что приводит к корреляции.

### Модифицированные тесты
- **KSρ, ADρ, LRρ**:
  - Скорректированные версии тестов, учитывающие корреляции, вызванные перекрывающимися интервалами.

---

## Основные возможности
1. **Обработка данных**:
   - Импорт данных из форматов CSV, Excel или JSON.
   - Генерация синтетических временных рядов на основе нормальной диффузионной модели.

2. **Реализация тестов**:
   - Стандартные тесты (KS, AD, LR).
   - Модифицированные версии тестов (KSρ, ADρ, LRρ) с учетом корреляций.

3. **Аналитические инструменты**:
   - Монте-Карло симуляции для генерации распределений тестовых статистик.
   - Построение ROC-кривых и расчет показателя True Positive Rate (TPR).
   - Оценка дискриминационной мощности (DP) для ранжирования тестов.

4. **Визуализация и экспорт**:
   - Построение графиков распределений и ROC-кривых.
   - Экспорт результатов в формате CSV или PDF.

---

## Функциональные и системные требования

### Функциональные требования

1. **Импорт данных**:
   - Поддержка импорта временных рядов.
   - Возможность загрузки данных для анализа и тестирования.

2. **Генерация данных**:
   - Генерация синтетических временных рядов на основе:
     - **Арифметического броуновского движения (ABM)**.
     - **Модели Кокса-Ингерсолла-Росса (CIR)**.
   - Поддержка различных параметров для генерации данных: волатильность, коэффициент возврата к среднему, дрейф, начальное значение.

3. **Реализация тестов**:
   - Поддержка стандартных тестов:
     - **Тест Колмогорова-Смирнова (KS)**.
     - **Тест Андерсона-Дарлинга (AD)**.
     - **Тест отношения правдоподобия (LR)**.
   - Поддержка модифицированных тестов (KSρ, ADρ, LRρ) для учета корреляций, вызванных перекрывающимися интервалами.

4. **Монте-Карло симуляции**:
   - Проведение симуляций для генерации распределений тестовых статистик.
   - Поддержка как перекрывающихся, так и неперекрывающихся наблюдений.

5. **Анализ параметров модели**:
   - Тестирование на основе изменения:
     - **Волатильности** (для ABM и CIR).
     - **Коэффициента возврата к среднему** (для CIR).
     - **Дрейфа** (для CIR).

6. **Визуализация данных**:
   - Построение графиков распределений тестовых статистик.
   - Построение ROC-кривых.
   - Визуализация траекторий временных рядов для ABM и CIR.

7. **Оценка дискриминационной мощности (DP)**:
   - Ранжирование тестов по их способности правильно идентифицировать модель с определенным дефектом.
   - Расчет DP для различных комбинаций тестов и параметров модели.

8. **Экспорт результатов**:
   - Возможность сохранения результатов тестов и графиков в форматах:
     - CSV (для табличных данных).
     - PDF (для графиков и отчетов).

9. **Поддержка нескольких моделей**:
   - **ABM**: Используется для тестирования волатильности в простых случаях.
   - **CIR**: Используется для тестирования более сложных моделей с учетом возврата к среднему и дрейфа.

10. **Обработка данных**:
    - Преобразование временных рядов в униформные значения для тестирования.
    - Поддержка обработки многомерных данных.

11. **Поддержка различных горизонтов тестирования**:
    - Возможность настройки горизонта тестирования (h) и частоты обновления (d) для перекрывающихся и неперекрывающихся наблюдений.

12. **Настройка параметров тестирования**:
    - Возможность настройки параметров тестов (например, количество симуляций, горизонт тестирования, частота обновления).


### Системные требования
- **Операционная система**: Windows, macOS или Linux.
- **Версия Python**: Python 3.7 или выше.
- **Необходимые библиотеки**:
  - `NumPy` (генерация данных, матричные вычисления)
  - `SciPy` (статистические расчеты)
  - `Matplotlib` (визуализация данных)
  - `Pandas` (обработка временных рядов)
- **Оборудование**:
  - Минимум: 4 ГБ ОЗУ.
  - Рекомендуется: многопроцессорная архитектура для выполнения Монте-Карло симуляций.

---

## Установка

### Предварительные требования
1. Установите Python версии 3.7 или выше.
2. Установите необходимые библиотеки:
   ```bash
   pip install numpy scipy matplotlib pandas
   ```

---

## Использование

### Пример работы
1. **Импорт временных рядов**:
   Поместите данные из архива path в папку с именем "path" в директорию с файлом clayton.ipynb.

2. **Запуск тестов**:
   Выполните скрипт для проведения тестов (KS, AD, LR) с перекрывающимися или неперекрывающимися наблюдениями.

3. **Визуализация результатов**:
   Скрипт создаст графики распределений тестовых статистик и ROC-кривых.

4. **Экспорт результатов**:
   Результаты можно сохранить в формате CSV или PDF для дальнейшего анализа.

---

### Детали реализации

1. **Используемые библиотеки**:
   - `NumPy`: для генерации случайных данных, создания ковариационных матриц и работы с многомерными нормальными распределениями.
   - `Matplotlib`: для построения графиков плотности.
   - `Pandas`: для обработки данных временных рядов.
   - `SciPy`: для статистических расчетов (например, кумулятивные распределения).
   - `Warnings`: для подавления незначительных предупреждений.

2. **Ключевые компоненты**:
   - **Класс `ArithmeticBrownianMotion`**:
     - Имитация процесса арифметического броуновского движения (ABM) с учетом параметров:
       - Волатильность (`sigma`),
       - Горизонт тестирования (`h`),
       - Частота обновления (`d`),
       - Количество симуляций (`n_paths`).
     - Основные методы:
       - `get_paths`: Генерация траекторий временных рядов с использованием метода Эйлера.
       - `get_stationary_value`: Расчет стационарных значений, нормализованных по волатильности.
       - `get_uniform_value`: Преобразование значений в униформные (для использования в тестах).
    - **Класс `CoxIngersollRoss`**:
      - Имитация процесса CIR с учетом параметров:
         - Волатильность (`sigma`): Параметр, определяющий степень изменчивости процесса.
         - Коэффициент возврата к среднему (`kappa`): Скорость, с которой процесс возвращается к своему среднему значению.
         - Дрейф (`theta`): Среднее значение, к которому процесс стремится.
         - Начальное значение (`startpoint`): Начальное значение процесса.
      - Основные методы:
         - `simulateTrajectory`: Генерация траекторий временных рядов на основе модели CIR.
   - **Функция `covariation_matrix`**:
     - Создает ковариационную матрицу для моделирования зависимости между перекрывающимися временными интервалами.
   - **Функции анализа распределений**:
     - `density_sample_series`: Вычисляет и визуализирует плотность распределения для одномерных данных.
     - `density_sample_dataframe`: Вычисляет среднюю плотность распределения для многомерных временных рядов.
